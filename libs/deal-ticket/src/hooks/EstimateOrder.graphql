query EstimateOrder(
  $marketId: ID!
  $partyId: ID!
  $price: String
  $size: String!
  $side: Side!
  $timeInForce: OrderTimeInForce!
  $expiration: Timestamp
  $type: OrderType!
) {
  estimateOrder(
    marketId: $marketId
    partyId: $partyId
    price: $price
    size: $size
    side: $side
    timeInForce: $timeInForce
    expiration: $expiration
    type: $type
  ) {
    fee {
      makerFee
      infrastructureFee
      liquidityFee
    }
    marginLevels {
      market {
        id
        state
        tradableInstrument {
          instrument {
            code
            name
          }
          marginCalculator {
            scalingFactors {
              searchLevel
              initialMargin
              collateralRelease
            }
          }
        }
      }
      asset {
        id
        name
      }
      party {
        id
      }
      initialLevel
      searchLevel
      maintenanceLevel
      collateralReleaseLevel
      timestamp
    }
    totalFeeAmount
  }
}
